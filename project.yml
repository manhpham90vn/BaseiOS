name: My Project
configs:
  Debug: debug
  Staging: release
  Release: release
options:
  createIntermediateGroups: true
  groupSortPosition: top
  generateEmptyDirectories: true
  indentWidth: 4
  tabWidth: 4
  bundleIdPrefix: "com.manhpham"
settings:
  PRODUCT_BUNDLE_IDENTIFIER: $(PRODUCT_BUNDLE_IDENTIFIER)
targets:
  MyApp:
    type: application
    platform: iOS
    deploymentTarget: "12.0"
    sources: Sources
    configFiles:
      Debug: Sources/Configs/BuildConfigurations/Debug.xcconfig
      Staging: Sources/Configs/BuildConfigurations/Staging.xcconfig
      Release: Sources/Configs/BuildConfigurations/Release.xcconfig
    settings:
      INFOPLIST_FILE: Sources/Resources/Info.plist
      SWIFT_VERSION: "5.0"
      SWIFT_OBJC_BRIDGING_HEADER: Sources/Resources/MyApp-Bridging-Header.h
      CODE_SIGN_STYLE: "Manual"
      UISupportedInterfaceOrientations: UIInterfaceOrientationPortrait
      UILaunchStoryboardName: LaunchScreen
      VALIDATE_WORKSPACE: YES
      CODE_SIGN_ENTITLEMENTS: Sources/Resources/MyApp.entitlements
    preBuildScripts:
      - name: Generate
        script: |
          scripts/mint/generate.sh
    postCompileScripts:
      - name: GoogleServiceInfo
        script: |
          PATH_TO_GOOGLE_PLISTS="${PROJECT_DIR}/Sources/Configs/GoogleServices"
          case "${CONFIGURATION}" in
          "Debug" )
          cp -r "$PATH_TO_GOOGLE_PLISTS/GoogleService-Info-Debug.plist" "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" ;;
          "Staging" )
          cp -r "$PATH_TO_GOOGLE_PLISTS/GoogleService-Info-Staging.plist" "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" ;;
          "Release" )
          cp -r "$PATH_TO_GOOGLE_PLISTS/GoogleService-Info-Release.plist" "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" ;;
          *)
          ;;
          esac
    postBuildScripts:
      - name: Crashlytics
        script: |
          "${PODS_ROOT}/FirebaseCrashlytics/run"
        inputFiles:
          - $(BUILT_PRODUCTS_DIR)/$(INFOPLIST_PATH)
          - ${DWARF_DSYM_FOLDER_PATH}/${DWARF_DSYM_FILE_NAME}/Contents/Resources/DWARF/${TARGET_NAME}
  MyAppTests:
    type: bundle.unit-test
    platform: iOS
    settings:
      TEST_HOST: $(BUILT_PRODUCTS_DIR)/My App Debug.app/My App Debug
      LD_RUNPATH_SEARCH_PATHS: $(inherited) '@executable_path/Frameworks' '@loader_path/Frameworks' $(FRAMEWORK_SEARCH_PATHS)
      IPHONEOS_DEPLOYMENT_TARGET: 12.0
    sources: SourcesTests
    dependencies:
      - target: MyApp
schemes:
  My Project:
    build:
      targets:
        MyApp: all
    run:
      config: Debug
    test:
      config: Debug
      gatherCoverageData: true
      targets:
        - name: MyAppTests
          parallelizable: false
          randomExecutionOrder: true
    profile:
      config: Debug
    analyze:
      config: Debug
    archive:
      config: Release
